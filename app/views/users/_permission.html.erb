<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr>
      <th>Funcionalidade</th>
      <th>Acesso</th>
    </tr>
  </thead>

  <% if f.object.errors[:permissions].present? %>
    <div class="alert alert-danger alert-block ">
      <i class="fa-fw fa fa-times"></i>
      <span class="help-inline">
        <%= raw(f.object.errors[:permissions].join("<br />")) %>
      </span>
    </div>
  <% end %>
  <%= hidden_field_tag :user_id, f.object.id %>

  <% @permissions.each do |permission| %>
    <%= f.fields_for :user_permissions,
        @user.permissions.find_by(permission: permission) do |p| %>
      <tr class="nested-fields" id="user-<%= permission.feature %>" <%= access_level_tags(permission) %> >
        <td>
          <%= permission.feature_humanize %>
          <%= p.hidden_field :feature, as: :hidden, value: permission.id %>
          <%= p.hidden_field :id, as: :hidden %>
        </td>

        <td>
          <%= p.input :permission, as: :select2, elements: permissions(permission.feature), label_html: { class: "hidden" } %>
        </td>
      </tr>
    <% end %>
  <% end %>
</table>

